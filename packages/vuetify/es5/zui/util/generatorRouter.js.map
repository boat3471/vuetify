{"version":3,"sources":["../../../src/zui/util/generatorRouter.ts"],"names":[],"mappings":"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","sourcesContent":["import { Location, RawLocation, Route, RouteConfig } from 'vue-router'\nimport { RedirectOption, RouterOptions } from 'vue-router/types/router'\nimport ZView403 from '../components/ZAdmin/ZView403'\nimport ZView500 from '../components/ZAdmin/ZView500'\nimport ZView404 from '../components/ZAdmin/ZView404'\nimport ZDefaultLogin from '../components/ZAdmin/ZDefaultLogin'\nimport ZAdmin from '../components/ZAdmin'\nimport { ZMenuOption, ZRouterOptions } from '../../../types'\n\n/**\n * 生成异常路由\n * @param name\n * @param path\n */\nexport function genExceptionRoute (name = '', path = ''): RouteConfig[] {\n  const list: RouteConfig[] = []\n  list.push({\n    name: `${name}-403`,\n    path: `${path}/403`.replace(/\\/\\//g, '/'),\n    component: ZView403,\n  })\n  list.push({\n    name: `${name}-500`,\n    path: `${path}/500`.replace(/\\/\\//g, '/'),\n    component: ZView500,\n  })\n  list.push({\n    name: `${name}-404`,\n    path: `${path}/*`.replace(/\\/\\//g, '/'),\n    component: ZView404,\n  })\n  return list\n}\n\n/**\n * 添加404\n * @param route\n * @param notFound\n */\nexport function addNotFoundRoute (route: RouteConfig, notFound: any): void {\n  if (route.children && route.children.length > 0) {\n    if (route.path !== '/') {\n      route.children.push({ path: '*', component: notFound })\n    }\n    route.children.forEach(child => addNotFoundRoute(child, notFound))\n  }\n}\n\n/**\n * 根据选项生成路由列表\n */\nexport function genRoutesByOptions (options: ZRouterOptions, menus: ZMenuOption[], routeRoot?: RouteConfig): RouteConfig[] {\n  const routerOptions: RouterOptions = options.options || {}\n  const routeLogin: RouteConfig = { name: 'r__login', path: '/login', component: ZDefaultLogin }\n  const route500: RouteConfig = { name: 'r__500', path: '/500', component: ZView500 }\n  const route403: RouteConfig = { name: 'r__403', path: '/403', component: ZView403 }\n  const route404: RouteConfig = { name: 'r__404', path: '/404', component: ZView404 }\n  const routeNotFound: RouteConfig = { name: 'r__not__found', path: '*', component: ZView404 }\n  routeRoot = routeRoot || { name: 'r__root', path: '/*', component: ZAdmin, children: [routeNotFound] }\n\n  /** 路由集 */\n  const routes: RouteConfig[] = [\n    routeLogin,\n    route500,\n    route403,\n    route404,\n    routeRoot,\n  ]\n\n  // 初始化用户自定义路由\n  let tempRedirect: string | Location | ((to: Route) => RawLocation) | undefined\n  const tempRoutes: RouteConfig[] = routerOptions.routes || []\n  tempRoutes.forEach(route => {\n    if (route && route.path) {\n      if (route.path === '/') {\n        tempRedirect = route.redirect || ''\n      }\n      route.path = genFullPath(route.path)\n      // 检查是否和默认路由冲突，冲突则将用户路由覆盖默认路由\n      const tempRoute = routes.find(i => i.path === route.path)\n      if (tempRoute) {\n        Object.assign(tempRoute, route)\n      } else {\n        // 给路由增加 404\n        addNotFoundRoute(route, route404.component)\n        routes.splice(4, 0, route)\n      }\n    }\n  })\n\n  addNotFoundRoute(routeRoot, route404.component)\n\n  const redirect = options.routeHome ? options.routeHome.redirect : (tempRedirect || '/home')\n  routeRoot.children = createRoutesByMenus(menus, redirect)\n\n  options.routeHome && Object.assign(routeRoot, options.routeHome)\n  options.routeLogin && Object.assign(routeLogin, options.routeLogin)\n  options.route500 && Object.assign(route500, options.route500)\n  options.route403 && Object.assign(route403, options.route403)\n  options.route404 && Object.assign(route404, options.route404)\n  options.route404 && Object.assign(routeNotFound, options.route404)\n\n  return routes\n}\n\nexport function genAppRoutesByOptions (options: ZRouterOptions, menus: ZMenuOption[]): RouteConfig[] {\n  const routeNotFound: RouteConfig = { name: 'r__not__found', path: '/*', component: ZView404 }\n  return genRoutesByOptions(options, menus, routeNotFound)\n}\n\n/**\n * 根据菜单生成路由列表\n * @param menus\n * @param rootList\n * @param parentPath\n */\nexport function genRoutesByMenus (menus: ZMenuOption[], rootList: RouteConfig[], parentPath = '/'): RouteConfig[] {\n  const list: RouteConfig[] = []\n  if (menus) {\n    menus.forEach(menu => {\n      if (!menu.path && !menu.href && (!menu.children || menu.children.length < 1)) {\n        window.console.warn(`菜单配置无法生成路由: \\n ${JSON.stringify(menu, null, 4)}`)\n        return\n      }\n      menu.path = menu.path || ''\n      let path = (menu.path || '').indexOf('/') === 0 ? menu.path : `${parentPath}/${menu.path}`\n      path = path.replace(/\\/{2,}/g, '/')\n      if (menu.path) {\n        const route: RouteConfig = {\n          name: menu.name,\n          path: path || '',\n          component: menu.component,\n          meta: {\n            name: menu.name || menu.title,\n            ...menu.meta,\n          },\n        }\n\n        if (menu.redirect) {\n          route.redirect = menu.redirect\n        }\n\n        if (menu.alias) {\n          route.alias = menu.alias\n        }\n\n        if (menu.beforeEnter) {\n          route.beforeEnter = menu.beforeEnter\n        }\n\n        route.name = (route.path || '').replace(/\\//g, '-')\n\n        rootList.push(route)\n      }\n\n      if (menu.children && menu.children.length > 0) {\n        genRoutesByMenus(menu.children, rootList, path)\n      }\n    })\n  }\n  return list\n}\n\n/**\n * 根据菜单创建路由列表\n * @param menus\n * @param redirect\n */\nexport function createRoutesByMenus (menus: ZMenuOption[] = [], redirect: RedirectOption = '/home'): RouteConfig[] {\n  if (menus && menus.length > 0) {\n    const children: RouteConfig[] = []\n    children.push(...genRoutesByMenus(menus, children, '/'))\n    children.push(...genExceptionRoute())\n    // children.push({ name: '--empty', path: '', redirect })\n    return children\n  }\n  return []\n}\n\n/**\n * 生成完整路径\n * @param path\n * @param parentPath\n */\nexport function genFullPath (path: string, parentPath?: string): string {\n  if (path.indexOf('/') !== 0) {\n    return `/${parentPath || ''}/${path}`.replace(/\\/+/g, '/')\n  }\n  return path\n}\n"],"sourceRoot":"","file":"generatorRouter.js"}