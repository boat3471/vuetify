{"version":3,"sources":["../../src/zui/ZRouter.ts"],"names":[],"mappings":";;;;;;;AAAA;;AAIA;;;;;;;;;;;;;;;;AAEA,IAAI,QAAJ;;IAEa,Y;;;AAmDX,0BAAA;AAAA;;AACE,QAAI,CAAC,QAAL,EAAe;AACb,MAAA,QAAQ,GAAG,IAAX;AACD;;AACD,WAAO,QAAP;AACD;;;;gCA/CQ;AACP,aAAO,YAAY,CAAC,MAApB;AACD;;;uCAE0C;AAAA,UAAzB,KAAyB,uEAAF,EAAE;AACzC,UAAM,MAAM,GAAG,KAAK,aAApB;;AACA,UAAI,MAAJ,EAAY;AACV,YAAM,OAAO,GAAG,YAAY,CAAC,OAAb,IAAwB,EAAxC;AACA,QAAA,YAAY,CAAC,KAAb,GAAqB,KAAK,GAAG,KAAK,IAAI,EAAtC;AAEA,YAAM,MAAM,GAAkB,yCAAmB,OAAnB,EAA4B,KAA5B,CAA9B;AACA,YAAM,aAAa,GAAkB,OAAO,CAAC,OAAR,IAAmB,MAAM,CAAC,MAAP,CAAc,IAAd,CAAxD;AACA,QAAA,aAAa,CAAC,MAAd,GAAuB,MAAvB;AAEA,YAAM,SAAS,GAAG,IAAI,kBAAJ,CAAc,aAAd,CAAlB;AAEC,QAAA,MAAc,CAAC,OAAf,GAA0B,SAAiB,CAAC,OAA5C,CAVS,CAYV;;AACA,YAAM,KAAK,GAAG,MAAM,CAAC,YAArB;AACA,QAAA,MAAM,CAAC,OAAP,CAAe;AAAE,UAAA,IAAI,EAAE,KAAK,CAAC,IAAd;AAAoB,UAAA,KAAK,oBAAO,KAAK,CAAC,KAAb;AAAoB,YAAA,CAAC,EAAE,IAAI,CAAC,GAAL,KAAa;AAApC;AAAzB,SAAf,EAAoF,IAApF;AACA,QAAA,MAAM,CAAC,OAAP,CAAe;AAAE,UAAA,IAAI,EAAE,KAAK,CAAC,IAAd;AAAoB,UAAA,KAAK,oBAAO,KAAK,CAAC,KAAb;AAAzB,SAAf,EAAgE,IAAhE;AACD;AACF;AAED;;;;;;;4BAIS,O,EAAyB,K,EAAoB;AACpD,MAAA,YAAY,CAAC,OAAb,GAAuB,OAAO,GAAG,OAAO,IAAI,EAA5C;AACA,MAAA,YAAY,CAAC,KAAb,GAAqB,KAAK,GAAG,KAAK,IAAI,EAAtC;AAEA,UAAM,MAAM,GAAkB,yCAAmB,OAAnB,EAA4B,KAA5B,CAA9B;AACA,UAAM,aAAa,GAAkB,OAAO,CAAC,OAAR,IAAmB,MAAM,CAAC,MAAP,CAAc,IAAd,CAAxD;AACA,MAAA,aAAa,CAAC,MAAd,GAAuB,MAAvB;AAEA,UAAM,MAAM,GAAG,IAAI,kBAAJ,CAAc,aAAd,CAAf;AACA,MAAA,YAAY,CAAC,MAAb,GAAsB,MAAtB;AACA,aAAO,MAAP;AACD;;;wBAhDgB;AACf,aAAO,YAAY,CAAC,MAApB;AACD;;;wBAEmB;AAClB,aAAO,YAAY,CAAC,MAAb,CAAoB,YAApB,CAAiC,IAAxC;AACD;;;kCAuDiB;AAChB,UAAI,CAAC,QAAL,EAAe;AACb,QAAA,QAAQ,GAAG,IAAI,YAAJ,EAAX;AACD;;AACD,aAAO,QAAP;AACD;;;;;;;AAGI,IAAM,OAAO,GAAG,YAAY,CAAC,WAAb,EAAhB","sourcesContent":["import VueRouter, { RouteConfig } from 'vue-router'\nimport { RouterOptions } from 'vue-router/types/router'\nimport { ZMenuOption, ZRouterOptions } from '../../types'\nimport { ZRouterDescription } from '../../types/zui/ZRouter'\nimport { genRoutesByOptions } from './util/generatorRouter'\n\nlet instance: ZRouterClass\n\nexport class ZRouterClass implements ZRouterDescription {\n  get currentRouter (): VueRouter {\n    return ZRouterClass.router\n  }\n\n  get currentRoutePath (): string {\n    return ZRouterClass.router.currentRoute.path\n  }\n\n  getRouter (): VueRouter {\n    return ZRouterClass.router\n  }\n\n  addRoutesByMenus (menus: ZMenuOption[] = []) {\n    const router = this.currentRouter\n    if (router) {\n      const options = ZRouterClass.options || {}\n      ZRouterClass.menus = menus = menus || []\n\n      const routes: RouteConfig[] = genRoutesByOptions(options, menus)\n      const routerOptions: RouterOptions = options.options || Object.create(null)\n      routerOptions.routes = routes\n\n      const newRouter = new VueRouter(routerOptions);\n\n      (router as any).matcher = (newRouter as any).matcher\n\n      // 强制刷新当前路由\n      const route = router.currentRoute\n      router.replace({ path: route.path, query: { ...route.query, t: Date.now() + '' } }).then()\n      router.replace({ path: route.path, query: { ...route.query } }).then()\n    }\n  }\n\n  /**\n   * 设置路由器\n   * @internal\n   */\n  setting (options: ZRouterOptions, menus: ZMenuOption[]): VueRouter {\n    ZRouterClass.options = options = options || {}\n    ZRouterClass.menus = menus = menus || []\n\n    const routes: RouteConfig[] = genRoutesByOptions(options, menus)\n    const routerOptions: RouterOptions = options.options || Object.create(null)\n    routerOptions.routes = routes\n\n    const router = new VueRouter(routerOptions)\n    ZRouterClass.router = router\n    return router\n  }\n\n  constructor () {\n    if (!instance) {\n      instance = this\n    }\n    return instance\n  }\n\n  static menus?: ZMenuOption[]\n  static options?: ZRouterOptions\n  static router: VueRouter\n\n  static genInstance (): ZRouterClass {\n    if (!instance) {\n      instance = new ZRouterClass()\n    }\n    return instance\n  }\n}\n\nexport const ZRouter = ZRouterClass.genInstance()\n"],"sourceRoot":"","file":"ZRouter.js"}