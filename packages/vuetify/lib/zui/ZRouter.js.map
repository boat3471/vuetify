{"version":3,"sources":["../../src/zui/ZRouter.ts"],"names":[],"mappings":"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","sourcesContent":["import VueRouter, { Route, RouteConfig } from 'vue-router'\nimport { RedirectOption, RouterOptions } from 'vue-router/types/router'\nimport { CreateAdminRouterOptions, CreateAppRouterOptions, RouteComponent, ZMenuOption } from '../../types'\nimport { ZRouterDescription } from '../../types/zui/ZRouter'\nimport { ZAdmin, ZApp } from '../components'\nimport { ZView403, ZView404, ZView500, ZDefaultLogin } from './components/ZAdmin'\nimport Vue from 'vue'\n\nlet instance: ZRouterClass\n\nexport class ZAppRouter {\n  protected _router: VueRouter | null = null\n  appHome?: RouteComponent\n  appMain?: RouteComponent\n  appLogin?: RouteComponent\n  appNotAccess?: RouteComponent\n  appNotFound?: RouteComponent\n  appServerError?: RouteComponent\n\n  isRenderRouterView = false\n\n  routerOptions?: RouterOptions\n\n  genRoute (path: string, comp: RouteComponent | boolean | undefined, def: RouteComponent): RouteConfig[] {\n    if (comp === true) {\n      return [{ path, component: def }]\n    }\n    if (comp) {\n      return [{ path, component: comp }]\n    }\n    return []\n  }\n\n  getRouter (): VueRouter {\n    if (this._router) {\n      return this._router\n    }\n    this._router = new VueRouter(this.routerOptions)\n    return this._router\n  }\n\n  addNotFoundRoute (route: RouteConfig, notFoundComponent: RouteComponent): void {\n    if (route.children && route.children.length > 0) {\n      // 如果已经存在，则不添加\n      const needed = !(route.children.some(i => i.path === '*') || route.path === '/' || route.path === '*')\n      if (needed) {\n        route.children.push({ path: '*', component: notFoundComponent })\n      }\n      route.children.forEach(child => this.addNotFoundRoute(child, notFoundComponent))\n    }\n  }\n\n  setting (options: CreateAppRouterOptions) {\n    if (options) {\n      this.isRenderRouterView = !options.appMain && !options.appHome\n\n      this.appHome = options.appHome\n      this.appMain = options.appMain || ZApp\n\n      const routerOptions: RouterOptions = options.routerOptions || Object.create(null)\n      const routes = routerOptions.routes || []\n\n      routes.push(...this.genRoute('/login', options.appLogin, ZDefaultLogin))\n      routes.push(...this.genRoute('/500', options.appServerError, ZView500))\n      routes.push(...this.genRoute('/403', options.appNotAccess, ZView403))\n      routes.push(...this.genRoute('*', options.appNotFound, ZView404))\n\n      routerOptions.routes = routes\n\n      this.routerOptions = routerOptions\n    }\n  }\n}\n\nexport class ZAdminRouter extends ZAppRouter {\n  genComp (usr: RouteComponent | boolean | undefined, def: RouteComponent): RouteComponent | undefined {\n    if (typeof usr === 'boolean') {\n      return usr ? def : undefined\n    }\n    return usr || def\n  }\n\n  get defaultHome () {\n    return Vue.extend({\n      name: 'z-admin-default-home',\n      render (h) {\n        return h('div', { staticClass: 'z-admin-default-home' })\n      },\n    })\n  }\n\n  /**\n   * 生成完整路径\n   * @param path\n   * @param parentPath\n   */\n  genFullPathByMenu (path: string, parentPath?: string): string {\n    if (path.indexOf('/') !== 0) {\n      return `/${parentPath || ''}/${path}`.replace(/\\/+/g, '/')\n    }\n    return path\n  }\n\n  parseUsrRoutes (routes: RouteConfig[], parentPath: string): RouteConfig[] {\n    const list: RouteConfig[] = []\n    routes.forEach(route => {\n      if (route) {\n        route.path = this.genFullPathByMenu(route.path)\n        route.name = route.name || `usr-${route.path.replace(/\\//g, '-')}`\n        list.push(route)\n      }\n    })\n    return list\n  }\n\n  /**\n   * 根据菜单生成路由列表\n   * @param menus\n   * @param rootList\n   * @param parentPath\n   */\n  genRoutesByMenus (menus: ZMenuOption[], rootList: RouteConfig[], parentPath = '/'): RouteConfig[] {\n    const list: RouteConfig[] = []\n    if (menus) {\n      menus.forEach(menu => {\n        if (!menu.path && !menu.href && (!menu.children || menu.children.length < 1)) {\n          window.console.warn(`菜单配置无法生成路由: \\n ${JSON.stringify(menu, null, 4)}`)\n          return\n        }\n        menu.path = menu.path || ''\n        let path = (menu.path || '').indexOf('/') === 0 ? menu.path : `${parentPath}/${menu.path}`\n        path = path.replace(/\\/{2,}/g, '/')\n        if (menu.path) {\n          const route: RouteConfig = {\n            name: menu.name,\n            path: path || '',\n            component: menu.component,\n            meta: {\n              name: menu.name || menu.title,\n              ...menu.meta,\n            },\n          }\n\n          if (menu.redirect) {\n            route.redirect = menu.redirect\n          }\n\n          if (menu.alias) {\n            route.alias = menu.alias\n          }\n\n          if (menu.beforeEnter) {\n            route.beforeEnter = menu.beforeEnter\n          }\n\n          route.name = (route.path || '').replace(/\\//g, '-')\n\n          rootList.push(route)\n        }\n\n        if (menu.children && menu.children.length > 0) {\n          this.genRoutesByMenus(menu.children, rootList, path)\n        }\n      })\n    }\n    return list\n  }\n\n  /** 生成异常路由 */\n  genExceptionRoute (name = '', path = ''): RouteConfig[] {\n    const list: RouteConfig[] = []\n    list.push({\n      name: `${name}-403`,\n      path: `${path}/403`.replace(/\\/\\//g, '/'),\n      component: ZView403,\n    })\n    list.push({\n      name: `${name}-500`,\n      path: `${path}/500`.replace(/\\/\\//g, '/'),\n      component: ZView500,\n    })\n    list.push({\n      name: `${name}-404`,\n      path: `${path}/*`.replace(/\\/\\//g, '/'),\n      component: ZView404,\n    })\n    return list\n  }\n\n  /**\n   * 根据菜单创建路由列表\n   * @param menus\n   * @param redirect\n   */\n  createRoutesByMenus (menus: ZMenuOption[] = [], redirect: RedirectOption = '/home'): RouteConfig[] {\n    if (menus && menus.length > 0) {\n      const children: RouteConfig[] = []\n      children.push(...this.genRoutesByMenus(menus, children, '/'))\n      children.push(...this.genExceptionRoute())\n      // children.push({ name: '--empty', path: '', redirect })\n      return children\n    }\n    return []\n  }\n\n  setting (options: CreateAdminRouterOptions) {\n    const NotFoundElement = this.genComp(options.appNotFound, ZView404)\n    const NotFoundRoute = { path: '*', component: NotFoundElement }\n    const routeLogin: RouteConfig = { name: 'r__login', path: '/login', component: this.genComp(options.appLogin, ZDefaultLogin) }\n    const route500: RouteConfig = { name: 'r__500', path: '/500', component: this.genComp(options.appServerError, ZView500) }\n    const route403: RouteConfig = { name: 'r__403', path: '/403', component: this.genComp(options.appNotAccess, ZView403) }\n    const route404: RouteConfig = { name: 'r__404', path: '/404', component: NotFoundElement }\n\n    const routeRoot404: RouteConfig = { name: 'r__root_404', path: '*', component: NotFoundElement }\n    const routeRoot: RouteConfig = { path: '/', component: options.appMain || ZAdmin }\n    const routeHome: RouteConfig = { path: '', component: options.appHome || this.defaultHome }\n\n    // 跟节点所有前置子节点\n    const beforeChildren: RouteConfig[] = [routeHome]\n    // 跟节点所有中置子节点\n    const middleChildren: RouteConfig[] = []\n    // 跟节点所有后置子节点\n    const afterChildren: RouteConfig[] = [NotFoundRoute]\n\n    // 给Home设置重定向\n    options.redirect && (routeHome.redirect = options.redirect)\n\n    const routerOptions = options.routerOptions || {}\n    const usrRoutes = routerOptions.routes || []\n    let usrRedirect: any = ''\n\n    usrRoutes.forEach(route => {\n      if (route.path === '/' || route.path === '') {\n        const children = route.children\n        delete route.children\n\n        if ('component' in route && route.component) {\n          routeHome.component = route.component\n        }\n        // 设置用户自定义的重定向，会忽略options中定义的重定向\n        !usrRedirect && (usrRedirect = route.redirect)\n\n        // 添加所有子组件到跟路由\n        middleChildren.push(...children)\n      } else {\n        middleChildren.push(route)\n      }\n    })\n\n    usrRedirect && (routeHome.redirect = usrRedirect)\n\n    const menuRoutes = this.createRoutesByMenus(options.menus, '')\n\n    routeRoot.children = [...beforeChildren, ...middleChildren, ...menuRoutes, ...afterChildren]\n\n    routerOptions.routes = [\n      routeLogin,\n      route500,\n      route403,\n      route404,\n      routeRoot,\n      routeRoot404,\n    ]\n    this.routerOptions = routerOptions\n  }\n}\n\nexport class ZRouterClass implements ZRouterDescription {\n  get self (): VueRouter {\n    return ZRouterClass.router\n  }\n\n  get currentRouter (): VueRouter {\n    return ZRouterClass.router\n  }\n\n  get currentRoute (): Route {\n    return ZRouterClass.router.currentRoute\n  }\n\n  get currentRoutePath (): string {\n    return ZRouterClass.router.currentRoute.path\n  }\n\n  getRouter (): VueRouter {\n    return ZRouterClass.router\n  }\n\n  addRoutesByMenus (menus: ZMenuOption[] = []) {\n    const router = this.currentRouter\n    if (router) {\n      const options = ZRouterClass.adminRouter || {}\n      ZRouterClass.menus = menus = menus || []\n\n      // todo 待完成，动态添加菜单\n      const routes: RouteConfig[] = [] // genRoutesByOptions(options)\n      const routerOptions: RouterOptions = options.routerOptions || Object.create(null)\n      routerOptions.routes = routes\n\n      const newRouter = new VueRouter(routerOptions);\n\n      (router as any).matcher = (newRouter as any).matcher\n\n      // 强制刷新当前路由\n      const route = router.currentRoute\n      router.replace({ path: route.path, query: { ...route.query, t: Date.now() + '' } }).then()\n      router.replace({ path: route.path, query: { ...route.query } }).then()\n    }\n  }\n\n  constructor () {\n    if (!instance) {\n      instance = this\n    }\n    return instance\n  }\n\n  static appRouter: ZAppRouter;\n  static adminRouter: ZAdminRouter;\n  static genAppRouter (options: CreateAppRouterOptions): ZAppRouter {\n    const appRouter = new ZAppRouter()\n    appRouter.setting(options)\n    ZRouterClass.appRouter = appRouter\n    return appRouter\n  }\n\n  static genAdminRouter (options: CreateAdminRouterOptions): ZAdminRouter {\n    const adminRouter = new ZAdminRouter()\n    adminRouter.setting(options)\n    ZRouterClass.adminRouter = adminRouter\n    return adminRouter\n  }\n\n  static menus?: ZMenuOption[]\n\n  static router: VueRouter\n\n  static genInstance (): ZRouterClass {\n    if (!instance) {\n      instance = new ZRouterClass()\n    }\n    return instance\n  }\n}\n\nexport const ZRouter = ZRouterClass.genInstance()\n"],"sourceRoot":"","file":"ZRouter.js"}