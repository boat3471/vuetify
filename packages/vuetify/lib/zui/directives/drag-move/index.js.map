{"version":3,"sources":["../../../../src/zui/directives/drag-move/index.ts"],"names":[],"mappings":"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","sourcesContent":["import { DirectiveOptions } from 'vue'\n\n/**\n * 使用说明\n * 1. 引入指令\n *      import dragMoveDirective from drag-move.directive.js\n * 2. 注册指令\n *      directive:{ dragMove: dragMoveDirective }\n * 3. 使用指令\n *      a. <component v-drag-move /> 整个容器都可触发拖动\n *      b. <component v-drag-move:activitor=\"['#id1','#id2','.className']\" 只有容器内#id1，#id2，.className 的元素可触发拖动\n */\n function getActivitorEls(el: HTMLElement, binding: any) {\n  if (binding.arg !== 'activitor') return [el];\n  const bindingValue = binding.value && Array.isArray(binding.value) ? binding.value : [];\n  let activitorEls: HTMLElement[] = [];\n\n  for (let i = 0, len = bindingValue.length; i < len; i++) {\n      const selector = bindingValue[i];\n      const activeEls = el.querySelectorAll(selector);\n      activeEls.length && (activitorEls = [...activitorEls, ...activeEls]);\n  }\n\n  return activitorEls.length ? activitorEls : [el];\n}\n\nexport const DragMove: DirectiveOptions = {\n  // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n  inserted(el: HTMLElement, binding: any) {\n      const dialogEl = el;\n      if (!dialogEl) return;\n      let isInited = false;\n      let mouseStartX = 0;\n      let mouseStartY = 0;\n      const activitorEls = getActivitorEls(el, binding);\n      let dialogHeight = 0;\n      let dialogWidth = 0;\n      let dialogY = 0;\n      let dialogX = 0;\n      let newDialogX = 0;\n      let newDialogY = 0;\n      activitorEls.forEach(activitorEl => {\n          // 第一次被拖动时初始化数据\n          activitorEl.addEventListener('mousedown', init);\n          activitorEl.addEventListener('mousedown', addMousemoveEvent);\n      }); // 初始化\n\n      function init() {\n          if (isInited) {\n              activitorEls.forEach(activitorEl => {\n                  activitorEl.removeEventListener('mousedown', init);\n              });\n              return;\n          }\n          const boundingClientRect = dialogEl.getBoundingClientRect();\n          dialogHeight = dialogEl.offsetHeight;\n          dialogWidth = dialogEl.offsetWidth;\n          dialogY = boundingClientRect.top;\n          dialogX = boundingClientRect.left;\n          dialogEl.style.cssText += `position:fixed; top: ${dialogY}px; left: ${dialogX}px; width:${dialogWidth}px; height:${dialogHeight}px;`;\n          isInited = true;\n      } // 添加鼠标事件\n\n      function addMousemoveEvent(e: MouseEvent) {\n          e.preventDefault();\n          document.body.addEventListener('mousedown', setMouseStartPos);\n          document.body.addEventListener('mousemove', handleMouseMove);\n          document.body.addEventListener('mouseup', setMouseDownElPos);\n          document.body.addEventListener('mouseup', removeMousemoveEvent);\n          document.body.addEventListener('mouseleave', setMouseDownElPos);\n          document.body.addEventListener('mouseleave', removeMousemoveEvent);\n      } // 移除鼠标事件\n\n      function removeMousemoveEvent() {\n          document.body.removeEventListener('mousedown', setMouseStartPos);\n          document.body.removeEventListener('mousemove', handleMouseMove);\n          document.body.removeEventListener('mouseup', setMouseDownElPos);\n          document.body.removeEventListener('mouseup', removeMousemoveEvent);\n          document.body.removeEventListener('mouseleave', removeMousemoveEvent);\n          document.body.removeEventListener('mouseleave', setMouseDownElPos);\n      }\n\n      function setMouseStartPos(e: MouseEvent) {\n          mouseStartX = e.x;\n          mouseStartY = e.y;\n      }\n\n      function setMouseDownElPos() {\n          dialogX = newDialogX;\n          dialogY = newDialogY;\n      }\n\n      function handleMouseMove(e: MouseEvent) {\n          const mouseDeltaX = e.x - mouseStartX;\n          const mouseDeltaY = e.y - mouseStartY;\n          newDialogX = dialogX + mouseDeltaX;\n          newDialogY = dialogY + mouseDeltaY;\n          //处理四周边界情况\n          if (newDialogY > window.innerHeight - dialogHeight) {\n              newDialogY = window.innerHeight - dialogHeight;\n          } else if (newDialogY < 0) {\n              newDialogY = 0;\n          }\n          if (newDialogX > window.innerWidth - dialogWidth) {\n              newDialogX = window.innerWidth - dialogWidth;\n          } else if (newDialogX < 0) {\n              newDialogX = 0;\n          }\n          dialogEl.style.left = newDialogX + 'px';\n          dialogEl.style.top = newDialogY + 'px';\n      }\n  },\n};\nexport default DragMove;\n//# sourceMappingURL=index.js.map\n"],"sourceRoot":"","file":"index.js"}